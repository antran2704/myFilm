{"ast":null,"code":"import _regeneratorRuntime from\"E:/sourceCode/myFilm/film/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"E:/sourceCode/myFilm/film/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"E:/sourceCode/myFilm/film/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import{useEffect,useState}from\"react\";import{AiOutlineLoading}from\"react-icons/ai\";import{useLocation}from\"react-router-dom\";import{useViewport}from\"../../../hook\";import\"./Search.scss\";import SearchItem from\"./SearchItem\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useQuery=function useQuery(){return new URLSearchParams(useLocation().search);};function Search(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var keywords=useQuery().get(\"keywords\");var _useViewport=useViewport(),_useViewport2=_slicedToArray(_useViewport,1),width=_useViewport2[0];var search=keywords.normalize(\"NFD\").toLowerCase().replace(\":\",\"\").replace(/ /g,\"-\").replace(/[\\u0300-\\u036f]/g,\"\").replace(/đ/g,\"d\").replace(/Đ/g,\"D\");// useEffect(() => {\n//   const handler = setTimeout(async () => {\n//     setLoading(true);\n//     await dispath(types.searchMovie(search.trim()));\n//     setLoading(false);\n//   }, 800);\n//   return () => {\n//     clearTimeout(handler);\n//   };\n// }, [search]);\nuseEffect(function(){var arr=[];var handler=setTimeout(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var i,_data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);i=1;case 2:if(!(i<=50)){_context.next=10;break;}_context.next=5;return axios.get(\"https://ophim1.com/danh-sach/phim-moi-cap-nhat?page=\".concat(i));case 5:_data=_context.sent;_data.data.items.map(function(items,index){if(items.slug.includes(search)){arr.push(items);}});case 7:i++;_context.next=2;break;case 10:setData(arr);setLoading(false);case 12:case\"end\":return _context.stop();}}},_callee);})),800);return function(){clearTimeout(handler);};},[search]);return/*#__PURE__*/_jsxs(\"div\",{className:\"search\",style:width>1200?{gridTemplateColumns:\"repeat(5,auto)\"}:width>1000?{gridTemplateColumns:\"repeat(4,auto)\"}:width>760?{gridTemplateColumns:\"repeat(3,auto)\"}:width>600?{gridTemplateColumns:\"repeat(2,auto)\"}:{gridTemplateColumns:\"repeat(1,auto)\"},children:[data&&data.map(function(data,index){return/*#__PURE__*/_jsx(SearchItem,{data:data},index);}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"search_loading\",children:/*#__PURE__*/_jsx(AiOutlineLoading,{className:\"search_loading-icon\"})})]});}export default Search;","map":{"version":3,"names":["axios","useEffect","useState","AiOutlineLoading","useLocation","useViewport","SearchItem","useQuery","URLSearchParams","search","Search","loading","setLoading","data","setData","keywords","get","width","normalize","toLowerCase","replace","arr","handler","setTimeout","i","items","map","index","slug","includes","push","clearTimeout","gridTemplateColumns"],"sources":["E:/sourceCode/myFilm/film/src/components/Pages/Search/Search.jsx"],"sourcesContent":["import axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { AiOutlineLoading } from \"react-icons/ai\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport { useViewport } from \"../../../hook\";\r\nimport \"./Search.scss\";\r\nimport SearchItem from \"./SearchItem\";\r\n\r\nconst useQuery = () => new URLSearchParams(useLocation().search);\r\n\r\nfunction Search() {\r\n  const [loading, setLoading] = useState(true);\r\n  const [data, setData] = useState();\r\n  const keywords = useQuery().get(\"keywords\");\r\n  const [width] = useViewport();\r\n  const search = keywords\r\n    .normalize(\"NFD\")\r\n    .toLowerCase()\r\n    .replace(\":\", \"\")\r\n    .replace(/ /g, \"-\")\r\n    .replace(/[\\u0300-\\u036f]/g, \"\")\r\n    .replace(/đ/g, \"d\")\r\n    .replace(/Đ/g, \"D\");\r\n  // useEffect(() => {\r\n  //   const handler = setTimeout(async () => {\r\n  //     setLoading(true);\r\n  //     await dispath(types.searchMovie(search.trim()));\r\n  //     setLoading(false);\r\n  //   }, 800);\r\n\r\n  //   return () => {\r\n  //     clearTimeout(handler);\r\n  //   };\r\n  // }, [search]);\r\n\r\n  useEffect(() => {\r\n    const arr = [];\r\n    const handler = setTimeout(async () => {\r\n      setLoading(true);\r\n      for (var i = 1; i <= 50; i++) {\r\n        const data = await axios.get(\r\n          `https://ophim1.com/danh-sach/phim-moi-cap-nhat?page=${i}`\r\n        );\r\n        data.data.items.map(function (items, index) {\r\n          if (items.slug.includes(search)) {\r\n            arr.push(items);\r\n          }\r\n        });\r\n      }\r\n\r\n      setData(arr);\r\n      setLoading(false);\r\n    }, 800);\r\n\r\n    return () => {\r\n      clearTimeout(handler);\r\n    };\r\n  }, [search]);\r\n  return (\r\n    <div\r\n      className=\"search\"\r\n      style={\r\n        width > 1200\r\n          ? { gridTemplateColumns: \"repeat(5,auto)\" }\r\n          : width > 1000\r\n          ? { gridTemplateColumns: \"repeat(4,auto)\" }\r\n          : width > 760\r\n          ? { gridTemplateColumns: \"repeat(3,auto)\" }\r\n          : width > 600\r\n          ? { gridTemplateColumns: \"repeat(2,auto)\" }\r\n          : { gridTemplateColumns: \"repeat(1,auto)\" }\r\n      }\r\n    >\r\n      {data &&\r\n        data.map(function (data, index) {\r\n          return <SearchItem key={index} data={data} />;\r\n        })}\r\n\r\n      {loading && (\r\n        <div className=\"search_loading\">\r\n          <AiOutlineLoading className=\"search_loading-icon\" />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Search;\r\n"],"mappings":"6VAAA,MAAOA,MAAP,KAAkB,OAAlB,CACA,OAASC,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,OAASC,gBAAT,KAAiC,gBAAjC,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,OAASC,WAAT,KAA4B,eAA5B,CACA,MAAO,eAAP,CACA,MAAOC,WAAP,KAAuB,cAAvB,C,wFAEA,GAAMC,SAAQ,CAAG,QAAXA,SAAW,SAAM,IAAIC,gBAAJ,CAAoBJ,WAAW,GAAGK,MAAlC,CAAN,EAAjB,CAEA,QAASC,OAAT,EAAkB,CAChB,cAA8BR,QAAQ,CAAC,IAAD,CAAtC,wCAAOS,OAAP,eAAgBC,UAAhB,eACA,eAAwBV,QAAQ,EAAhC,yCAAOW,IAAP,eAAaC,OAAb,eACA,GAAMC,SAAQ,CAAGR,QAAQ,GAAGS,GAAX,CAAe,UAAf,CAAjB,CACA,iBAAgBX,WAAW,EAA3B,8CAAOY,KAAP,kBACA,GAAMR,OAAM,CAAGM,QAAQ,CACpBG,SADY,CACF,KADE,EAEZC,WAFY,GAGZC,OAHY,CAGJ,GAHI,CAGC,EAHD,EAIZA,OAJY,CAIJ,IAJI,CAIE,GAJF,EAKZA,OALY,CAKJ,kBALI,CAKgB,EALhB,EAMZA,OANY,CAMJ,IANI,CAME,GANF,EAOZA,OAPY,CAOJ,IAPI,CAOE,GAPF,CAAf,CAQA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEAnB,SAAS,CAAC,UAAM,CACd,GAAMoB,IAAG,CAAG,EAAZ,CACA,GAAMC,QAAO,CAAGC,UAAU,wEAAC,iJACzBX,UAAU,CAAC,IAAD,CAAV,CACSY,CAFgB,CAEZ,CAFY,aAETA,CAAC,EAAI,EAFI,iDAGJxB,MAAK,CAACgB,GAAN,+DACsCQ,CADtC,EAHI,QAGjBX,KAHiB,eAMvBA,KAAI,CAACA,IAAL,CAAUY,KAAV,CAAgBC,GAAhB,CAAoB,SAAUD,KAAV,CAAiBE,KAAjB,CAAwB,CAC1C,GAAIF,KAAK,CAACG,IAAN,CAAWC,QAAX,CAAoBpB,MAApB,CAAJ,CAAiC,CAC/BY,GAAG,CAACS,IAAJ,CAASL,KAAT,EACD,CACF,CAJD,EANuB,OAEAD,CAAC,EAFD,+BAazBV,OAAO,CAACO,GAAD,CAAP,CACAT,UAAU,CAAC,KAAD,CAAV,CAdyB,uDAAD,GAevB,GAfuB,CAA1B,CAiBA,MAAO,WAAM,CACXmB,YAAY,CAACT,OAAD,CAAZ,CACD,CAFD,CAGD,CAtBQ,CAsBN,CAACb,MAAD,CAtBM,CAAT,CAuBA,mBACE,aACE,SAAS,CAAC,QADZ,CAEE,KAAK,CACHQ,KAAK,CAAG,IAAR,CACI,CAAEe,mBAAmB,CAAE,gBAAvB,CADJ,CAEIf,KAAK,CAAG,IAAR,CACA,CAAEe,mBAAmB,CAAE,gBAAvB,CADA,CAEAf,KAAK,CAAG,GAAR,CACA,CAAEe,mBAAmB,CAAE,gBAAvB,CADA,CAEAf,KAAK,CAAG,GAAR,CACA,CAAEe,mBAAmB,CAAE,gBAAvB,CADA,CAEA,CAAEA,mBAAmB,CAAE,gBAAvB,CAXR,WAcGnB,IAAI,EACHA,IAAI,CAACa,GAAL,CAAS,SAAUb,IAAV,CAAgBc,KAAhB,CAAuB,CAC9B,mBAAO,KAAC,UAAD,EAAwB,IAAI,CAAEd,IAA9B,EAAiBc,KAAjB,CAAP,CACD,CAFD,CAfJ,CAmBGhB,OAAO,eACN,YAAK,SAAS,CAAC,gBAAf,uBACE,KAAC,gBAAD,EAAkB,SAAS,CAAC,qBAA5B,EADF,EApBJ,GADF,CA2BD,CAED,cAAeD,OAAf"},"metadata":{},"sourceType":"module"}